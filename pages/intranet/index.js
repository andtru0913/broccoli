import Head from 'next/head'
import * as Database from "../../Database";
import styles from "../../styles/Home.module.css";
import formStyles from "./form.module.css"

export async function getServerSideProps(context) {
    let cookies = context.req.cookies['userid']
    let user = await Database.getUserinfo(cookies)
    return {
        props: {user: user === undefined ? null : user}
    }
}

export default function Home({user}) {
    if (user === null) {
        return (
            <div className={styles.container}>
                <Head>
                    <title>Intranet</title>
                    <meta name="description" content="Generated by create next app"/>
                    <link rel="icon" href="/public/favicon.ico"/>
                </Head>

                <main>
                    <div>
                        <h1>
                            Please log in
                        </h1>
                        <form className={formStyles.form} action="../../api/login" method="POST">
                            <input type="text" name="username" placeholder="Användarnamn"/>
                            <input type="password" name="password" placeholder="Lösenord"/>
                            <button type="submit">Log in</button>
                        </form>
                    </div>

                </main>
            </div>
        )
    } else {
        return (
            <div className={styles.container}>
                <Head>
                    <title>Admin</title>
                    <meta name="description" content="Generated by create next app" />
                    <link rel="icon" href="/public/favicon.ico" />
                </Head>

                <main className={styles.main}>
                    <div>
                        <h1>
                            Welcome {user.firstname}
                        </h1>
                        <a href='../api/logout'>log out</a>
                        <a href='./intranet/admin'>admin</a>
                        <a href='./intranet/calendar'>admin</a>
                    </div>
                </main>
            </div>
        )
    }
}
